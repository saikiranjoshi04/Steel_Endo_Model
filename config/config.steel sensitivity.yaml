# SPDX-FileCopyrightText: : 2017-2024 The PyPSA-Eur Authors
#
# SPDX-License-Identifier: CC0-1.0

# docs in https://pypsa-eur.readthedocs.io/en/latest/configuration.html#run
run:
  prefix: ""
  name: #"all"
  - regional_steel_demand_39_Seq_200_carbon_neutral
  - no_regional_steel_demand_39_Seq_200
  - regional_steel_demand_39_Seq_200_no_h2_network_carbon_neutral
  - regional_steel_demand_39_CCS_1875k
  scenarios:
    enable: true
    file: config/scenarios_steel_policy.yaml
  disable_progressbar: false
  shared_resources:
    policy: false
    exclude: []
  shared_cutouts: true

# docs in https://pypsa-eur.readthedocs.io/en/latest/configuration.html#foresight
foresight: overnight


# docs in https://pypsa-eur.readthedocs.io/en/latest/configuration.html#scenario
# Wildcard docs in https://pypsa-eur.readthedocs.io/en/latest/wildcards.html
scenario:
  simpl:
  - ''
  ll:
  - vopt
  clusters:
  - 39
  opts:
  - ''
  sector_opts:
  - ''
  planning_horizons:
  # - 2020
  # - 2025
  # - 2030
  # - 2035
  # - 2040
  # - 2045
  - 2050

# countries: ['DE']

existing_capacities:
  grouping_years_power: [1920, 1950, 1955, 1960, 1965, 1970, 1975, 1980, 1985, 1990, 1995, 2000, 2005, 2010, 2015, 2020]
  grouping_years_heat: [1980, 1985, 1990, 1995, 2000, 2005, 2010, 2015, 2019] # heat grouping years >= baseyear will be ignored


# docs in https://pypsa-eur.readthedocs.io/en/latest/configuration.html#co2-budget
co2_budget:
  2020: 0.720 # average emissions of 2019 to 2021 relative to 1990, excl LULUCF, EEA data, European Environment Agency. (2023a). Annual European Union greenhouse gas inventory 1990–2021 and inventory report 2023 - CRF Table. https://unfccc.int/documents/627830
  2025: 0.648 # With additional measures (WAM) projection, CO2 excl LULUCF, European Environment Agency. (2023e). Member States’ greenhouse gas (GHG) emission projections 2023. https://www.eea.europa.eu/en/datahub/datahubitem-view/4b8d94a4-aed7-4e67-a54c-0623a50f48e8
  2030: 0.450 # 55% reduction by 2030 (Ff55)
  2035: 0.300
  2040: 0.100 # 90% by 2040
  2045: 0.050
  2050: 0.000 # climate-neutral by 2050


# docs in https://pypsa-eur.readthedocs.io/en/latest/configuration.html#electricity
electricity:
  extendable_carriers:
    Generator: [solar, onwind, offwind-ac, offwind-dc, offwind-float, OCGT, CCGT]
    StorageUnit: [] # battery, H2
    Store: [battery, H2]
    Link: [] # H2 pipeline
  renewable_carriers: [solar, onwind, offwind-ac, offwind-dc, offwind-float, hydro]

existing_capacities:
  threshold_capacity_industry: 0.001

# docs
# TODO: PyPSA-Eur merge issue in prepare_sector_network.py
# regulate what components with which carriers are kept from PyPSA-Eur;
# some technologies are removed because they are implemented differently
# (e.g. battery or H2 storage) or have different year-dependent costs
# in PyPSA-Eur-Sec
pypsa_eur:
  Bus:
  - AC
  Link:
  - DC
  Generator:
  - onwind
  - offwind-ac
  - offwind-dc
  - offwind-float
  #- solar-hsat
  - solar
  - ror
  - nuclear
  StorageUnit:
  - PHS
  - hydro
  Store: []

# docs in https://pypsa-eur.readthedocs.io/en/latest/configuration.html#sector
sector:
  regional_coal_demand: true  #set to true if regional CO2 constraints needed
  endo_industry:    
    enable: true
    regional_steel_demand: true   # enable regional steel demand constraints
    
    existing_steel_plants:
      fallback_start_year: 2000             # Fallback when both retired and start year missing but capacities are present for EAF and DRI plants
      integrated_lookback_years: 39      # For Integrated steelworks: lookback years from retired date to infer start (retired - lookback)
      integrated_fallback_start_year: 2001  # For Integrated steelworks: fallback start year when no retired date is available
    
    steel_relocation: false   # enable directional steel flow relocation links
    hbi_relocation: false     # enable directional HBI flow relocation links
    
    # when steel relocation is active, these parameters define minimum local production shares
    steel_local_min_share: #Minimum share of steel production enabled when steel relocation is active
      DEFAULT: 0.3 # Global default minimum local share
      DE: 0.5 # Country specific minimum local share
    steel_local_min_bus_share:
      DEA12: 0.6 # Bus specific minimum local share

    steel_min_load: 0.5 # 50 % minimum load for BF/BOF steel plants
    dri_min_load: 0.4  # 40 % minimum load for DRI plants
    lifetime : 40 # lifetime for the steel plants built in the model

    relocation_fallback_rate_steel: 0.5 # EUR/km 
    relocation_tier_rates_steel: # https://www.kimnet.nl/site/binaries/site-content/collections/documents/2023/03/30/kostenkengetallen-voor-het-goederenvervoer/Cost%2Bfigures%2Bfor%2Bfreight%2Btransport_def.pdf
      "0_200": 0.144
      "200_500": 0.045
      "500_inf": 0.012
    
    relocation_fallback_rate_hbi: 0.5
    relocation_tier_rates_hbi:
      "0_200": 0.144
      "200_500": 0.045
      "500_inf": 0.012
    
    flexibility : false   # Stores are added for HBI and Steel to provide flexibility
    
    # If green_import is True, steel_import_price and hbi_import_price will be used for import prices
    green_import: false    
    # assumed green import prices in EUR/t steel or HBI
    steel_import_price:
      2020: 450
      2025: 525
      2030: 550
      2035: 650
      2040: 650
      2045: 675
      2050: 700
    hbi_import_price:
      2020: 400
      2025: 400
      2030: 400
      2035: 600
      2040: 500
      2045: 500
      2050: 500
    # assumed scrap prompt prices in EUR/t steel for Scrap based EAF production
    scrap_prompt_price:
      2020: 140
      2025: 140
      2030: 140
      2035: 140
      2040: 140
      2045: 140
      2050: 140
  co2_sequestration_potential:
    2020: 0
    2025: 0
    2030: 40
    2035: 100
    2040: 100
    2045: 400
    2050: 400

industry:
  EAF_only_scrap_growth_factor:
    2020: 1.00
    2025: 1.00 # 5% more scrap available in 2025 than in 2020
    2030: 1.00
    2035: 1.00
    2040: 1.00
    2045: 1.00
    2050: 1.00 # 30% more scrap available in 2050 than in 2020
  dri_eaf_plants: false

# docs in https://pypsa-eur.readthedocs.io/en/latest/configuration.html#clustering
clustering:
  # focus_weights:
  #   'AL': 0.005
  #   'AT': 0.045   # ~5 clusters
  #   'BA': 0.005
  #   'BE': 0.047   # ~5
  #   'BG': 0.005
  #   'CH': 0.005
  #   'CZ': 0.027   # ~3
  #   'DE': 0.239   # ~24
  #   'DK': 0.005
  #   'EE': 0.005
  #   'ES': 0.082   # ~8
  #   'FI': 0.021   # ~2
  #   'FR': 0.087   # ~9
  #   'GB': 0.044   # ~4–5
  #   'GR': 0.005
  #   'HR': 0.005
  #   'HU': 0.005
  #   'IE': 0.005
  #   'IT': 0.140   # ~14
  #   'LT': 0.005
  #   'LU': 0.005
  #   'LV': 0.005
  #   'ME': 0.005
  #   'MK': 0.005
  #   'NL': 0.040   # ~4
  #   'NO': 0.005
  #   'PL': 0.054   # ~5
  #   'PT': 0.005
  #   'RO': 0.021   # ~2
  #   'RS': 0.005
  #   'SE': 0.029   # ~3
  #   'SI': 0.005
  #   'SK': 0.024   # ~2–3
  #   'XK': 0.005
  temporal:
    resolution_sector: 144h # 144h #2190SEG # 365h # 720h

costs:
  year: 2050
  version: v0.13.3


# docs in https://pypsa-eur.readthedocs.io/en/latest/configuration.html#plotting
plotting:
  tech_colors:
    # Steel production routes
    primary route - blast furnace: "#C1663B"
    primary route - blast furnace CC: "#E6B89C"
    primary route - DRI: "#6a51a3"
    primary route - DRI CC: "#98DF8A"
    primary route - EAF(DRI based): "#1F9E89"
    secondary route - EAF: "#1F77B4"
    hbi: "#17BECF"
    iron: "#9467BD"
    se_iron: "#C5B0D5"
    scrap_steel: "#7F7F7F"
    import scrap steel: "#C7C7C7"
    hbi_import: "#9EDAE5"
    steel: "#E377C2"
    steel_import: "#F7B6D2"
    steel_relocation: "#F1A4C4"
    hbi_relocation: "#BFD3E6"
    steel process emissions: "#D62728"
    syn gas for DRI: "#FF7F0E"
    biomass to liquid CC: '#117733'
  balance_map:
    bus_carriers:
    - AC
    - H2
    - gas
    - co2 stored
    # - steel
    # - hbi
    steel:
      # Simplified steel balance map settings
      unit: Mt                    # Legend unit for bus and branch sizes
      unit_conversion: 1_000_000   # Convert tonnes (t) to Mt (ensure parsed as float, not string)
      region_unit: EUR/t          # Marginal price colorbar label
      cmap: Blues
      vmin: 0.5                 # Auto-scale
      vmax:
      bus_factor: 0.030             # Uniform simple scaling
      branch_factor: 0
      flow_factor: 0
      bus_sizes:
      - 50
      - 25
      branch_sizes:
    hbi:
      # Simplified HBI settings (mirroring steel for consistency)
      unit: Mt
      unit_conversion: 1_000_000
      region_unit: EUR/t
      cmap: Blues
      vmin:                 # Auto-scale
      vmax:
      bus_factor: 0.030             # Uniform simple scaling
      branch_factor: 0
      flow_factor: 0
      bus_sizes:
      - 50
      - 25
      branch_sizes:
